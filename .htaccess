# =====================================================
#  Imperial Compressors – Apache Configuration
# =====================================================

Options -Indexes

# ── Error Documents ──────────────────────────────────
ErrorDocument 400 /404.html
ErrorDocument 401 /404.html
ErrorDocument 403 /404.html
ErrorDocument 404 /404.html
# ErrorDocument 500 /404.html

# ── URL Cleanup: remove trailing slashes ─────────────
RewriteEngine On

# Remove www (optional – uncomment if you want to enforce non-www)
# RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
# RewriteRule ^ https://%1%{REQUEST_URI} [R=301,L]

# Force HTTPS (uncomment once SSL is live on the server)
# RewriteCond %{HTTPS} off
# RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# ── Prevent access to sensitive files ────────────────
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|sql|bak|env)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# ── Charset & MIME types ──────────────────────────────
AddDefaultCharset UTF-8

AddType application/javascript          .js
AddType text/css                        .css
AddType image/svg+xml                   .svg
AddType image/webp                      .webp
AddType font/woff2                      .woff2
AddType font/woff                       .woff

# ── Browser Caching ───────────────────────────────────
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault                          "access plus 1 month"

    # HTML – short cache for content updates
    ExpiresByType text/html                 "access plus 1 hour"

    # CSS & JS
    ExpiresByType text/css                  "access plus 1 year"
    ExpiresByType application/javascript    "access plus 1 year"

    # Images
    ExpiresByType image/png                 "access plus 1 year"
    ExpiresByType image/jpg                 "access plus 1 year"
    ExpiresByType image/jpeg                "access plus 1 year"
    ExpiresByType image/webp                "access plus 1 year"
    ExpiresByType image/svg+xml             "access plus 1 year"
    ExpiresByType image/gif                 "access plus 1 year"

    # Fonts
    ExpiresByType font/woff2                "access plus 1 year"
    ExpiresByType font/woff                 "access plus 1 year"
</IfModule>

# ── Gzip Compression ──────────────────────────────────
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/css application/javascript
    AddOutputFilterByType DEFLATE image/svg+xml application/json
    AddOutputFilterByType DEFLATE font/woff2 font/woff
</IfModule>

# ── Security Headers ──────────────────────────────────
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options  "nosniff"
    Header always set X-Frame-Options         "SAMEORIGIN"
    Header always set X-XSS-Protection        "1; mode=block"
    Header always set Referrer-Policy         "strict-origin-when-cross-origin"
</IfModule>
